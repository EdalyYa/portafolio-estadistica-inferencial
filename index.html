<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üìä Portafolio ‚Äî Estad√≠stica Inferencial | FIE</title>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@600;700&family=Kalam:wght@400;700&display=swap" rel="stylesheet">
  <!-- MathJax for formulas -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(','\\)'], ['$', '$']],
        displayMath: [['\\[','\\]'], ['$$','$$']],
        macros: {
          Pr: "\\operatorname{Pr}",
          Var: "\\operatorname{Var}",
          SE: "\\operatorname{SE}",
          MSE: "\\operatorname{MSE}",
          E: "\\mathbb{E}",
          Normal: ["\\mathcal{N}\\left(#1,#2\\right)", 2],
          tStudent: ["\\mathrm{t}_{#1}", 1],
          ChiSq: ["\\chi^2_{#1}", 1],
          FDist: ["\\mathrm{F}_{#1,#2}", 2]
        }
      },
      options: {
        // Permit processing inside <code> to soportar f√≥rmulas inline en listas
        skipHtmlTags: ['script','noscript','style','textarea','pre']
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script>
  <style>
    :root {
      --fie-red: #b91c1c; /* rojo FIE */
      --fie-gold: #f59e0b; /* dorado FIE */
      --fie-dark: #111827; /* casi negro */
      --paper: #fefefe;
      --line: #e3f2fd;
      --accent: #7c3aed; /* violeta acento */
      /* Espaciado base */
      --space-1: 6px;
      --space-2: 10px;
      --space-3: 14px;
      --space-4: 18px;
      --radius: 12px;
      /* Ajustes cuaderno universitario */
      --binder-strip-left: 48px;
      --binder-strip-width: 58px;
      --holes-left: 82px;
    }

    html, body { height: 100%; }
    body {
      margin: 0;
      background: linear-gradient(135deg, #3f0d0d 0%, #1f0a0a 100%);
      font-family: 'Kalam', cursive;
      color: #1f2937;
      overflow: hidden;
    }

    .app {
      display: grid;
      grid-template-columns: 240px 1fr;
      height: 100vh;
    }

    .sidebar {
      background: linear-gradient(180deg, var(--fie-red), #7f1d1d);
      padding: var(--space-3);
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.2);
    }

    .nav-btn {
      background: linear-gradient(145deg, var(--fie-gold), #d97706);
      color: #111;
      border: none;
      border-radius: var(--radius);
      padding: 12px 14px;
      font-family: 'Caveat', cursive;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    }

    .nav-btn.secondary { background: linear-gradient(145deg, #ef4444, #b91c1c); color: #fff; }

    /* √çndice de semanas */
    .weeks-list { display:flex; flex-direction:column; gap:8px; max-height: 42vh; overflow:auto; padding-right: 4px; }
    .weeks-list::-webkit-scrollbar { width: 6px; }
    .weeks-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.35); border-radius: 8px; }
    .week-item { text-align:left; background: rgba(255,255,255,0.15); color:#fff; border: 1px solid rgba(255,255,255,0.25); border-radius: 10px; padding: 9px 12px; font-family:'Kalam', cursive; font-size: 14px; cursor:pointer; }
    .week-item:hover { background: rgba(255,255,255,0.22); }
    .week-item.active { outline: 2px solid var(--fie-gold); background: rgba(245,158,11,0.25); color: #111; }

    .workspace {
      position: relative;
      padding: var(--space-4);
    }

    .notebook-container {
      position: relative;
      margin: 0 auto;
      width: min(980px, 100%);
      overflow: visible;
      padding-left: 12px;
    }

    /* Espiral tipo universitario a la izquierda */
    .spiral-binding {
      position: absolute;
      left: -10px;
      top: 24px;
      bottom: 24px;
      width: 52px;
      border-radius: 14px;
      background:
        radial-gradient(circle at 26px 18px, #202020 14px, rgba(32,32,32,0.65) 15px, transparent 16px) repeat-y,
        linear-gradient(90deg, #bdbdbd, #8f8f8f);
      background-size: 52px 50px, 100% 100%;
      background-position: 0 0, 0 0;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.4), 0 3px 10px rgba(0,0,0,0.3);
      z-index: 10;
      pointer-events: none;
    }
    .spiral-binding::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        linear-gradient(135deg, rgba(255,255,255,0.35) 0%, rgba(255,255,255,0.0) 40%) no-repeat,
        linear-gradient(315deg, rgba(0,0,0,0.15) 0%, rgba(0,0,0,0.0) 50%) no-repeat;
      background-size: 60% 100%, 55% 100%;
      background-position: left top, right top;
      pointer-events: none;
      mix-blend-mode: screen;
    }

    .notebook {
      background:
        linear-gradient(90deg, transparent 0px, transparent 35px, #ff6b6b 35px, #ff6b6b 37px, transparent 37px),
        repeating-linear-gradient(transparent, transparent 22px, var(--line) 22px, var(--line) 24px);
      background-color: var(--paper);
      border-radius: var(--radius);
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      min-height: 70vh;
      position: relative;
      overflow: visible;
    }

    /* Hojas apiladas detr√°s de la p√°gina */
    .notebook::before {
      content: "";
      position: absolute;
      inset: 10px -8px -10px 18px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(0,0,0,0.06), rgba(0,0,0,0.02));
      box-shadow:
        0 16px 32px rgba(0,0,0,0.18),
        -8px 0 0 rgba(0,0,0,0.06);
      z-index: -1;
    }

    /* Perforaciones integradas bajo el espiral */
    .notebook::after {
      content: "";
      position: absolute;
      left: calc(var(--binder-strip-left) + var(--binder-strip-width) / 2);
      top: 30px;
      width: 22px;
      height: calc(100% - 60px);
      background:
        radial-gradient(circle at 11px 20px, #cfcfcf 0 8px, rgba(0,0,0,0.08) 9px, transparent 10px) repeat-y;
      background-size: 22px 50px;
      filter: drop-shadow(-1px 1px 0 rgba(255,255,255,0.6)) drop-shadow(0 1px 2px rgba(0,0,0,0.15));
      z-index: 2;
      pointer-events: none;
    }

    /* Banda protectora lateral con textura */
    .binder-strip {
      position: absolute;
      left: var(--binder-strip-left);
      top: 0;
      bottom: 0;
      width: var(--binder-strip-width);
      background:
        repeating-linear-gradient(90deg, rgba(0,0,0,0.03) 0 3px, rgba(0,0,0,0.0) 3px 6px),
        linear-gradient(180deg, #f6e3be, #e9d0a2);
      box-shadow: inset 0 0 12px rgba(0,0,0,0.15);
      z-index: 1;
      pointer-events: none;
    }

    .page-content {
      padding: 28px 28px 28px 140px;
      min-height: 70vh;
      position: relative;
      overflow: hidden;
      /* Reinicia contador de ecuaciones por p√°gina */
      counter-reset: eqnum;
    }
    /* Espaciado tipo cuaderno */
    .page-content p { margin: 10px 0 12px; line-height: 1.8; }
    .page-content ul, .page-content ol { margin: 10px 0 14px 22px; line-height: 1.8; }
    .two-column-layout { gap: 20px; }

    /* Encabezado semanal */
    .page-header { display:flex; align-items:center; justify-content:space-between; background: linear-gradient(90deg, #fff8e7, #fef3c7); border:2px solid #d97706; border-radius:10px; padding:10px 14px; margin-bottom:14px; position:relative; }
    .page-header .crumb { font-family:'Caveat', cursive; color:#92400e; font-weight:700; }
    .page-header .topic { font-family:'Kalam', cursive; color:#b45309; font-weight:700; }
    .page-header .sticker { position:absolute; right:-8px; top:-10px; width:64px; height:28px; background: linear-gradient(145deg, var(--fie-red), #7f1d1d); transform: rotate(8deg); box-shadow:0 4px 10px rgba(0,0,0,0.25); border-radius:6px; }

    .page-number {
      position: absolute; bottom: 20px; right: 26px;
      border: 2px solid #6b7280; border-radius: 50%; width: 40px; height: 40px;
      display: flex; align-items: center; justify-content: center;
      font-family: 'Caveat', cursive; color: #6b7280; background: rgba(255,255,255,0.85);
    }

    /* Oreja de p√°gina y animaciones de ojeo */
    .page-dogear {
      position: absolute;
      top: -2px;
      right: -2px;
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, #fff8e7 0%, #fef3c7 60%, #f1d18a 100%);
      box-shadow: -2px 2px 6px rgba(0,0,0,0.25);
      clip-path: polygon(0 0, 100% 0, 100% 100%);
      border-top: 2px solid #d97706;
      border-right: 2px solid #d97706;
      z-index: 2;
    }
    .page-dogear::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(120% 120% at 0% 100%, rgba(0,0,0,0.20) 0%, rgba(0,0,0,0.0) 70%);
      clip-path: polygon(0 0, 100% 0, 100% 100%);
      pointer-events: none;
    }
    @keyframes pageEnterRight {
      0% { transform: translateX(24px); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    @keyframes pageEnterLeft {
      0% { transform: translateX(-24px); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    .page-enter-right { animation: pageEnterRight 500ms ease-out; }
    .page-enter-left  { animation: pageEnterLeft  500ms ease-out; }

    /* Portada FIE */
    .cover-page { position: relative; display: flex; flex-direction: column; align-items: center; gap: 12px; }
    .cover-page::before {
      content: "";
      position: absolute; inset: 0;
      background:
        repeating-linear-gradient(135deg, rgba(255,255,255,0.08) 0 6px, rgba(0,0,0,0.08) 6px 12px),
        linear-gradient(180deg, #f4c97b 0%, #eab867 100%);
      opacity: 0.35;
      pointer-events: none;
    }
    .logo-spaces { position: absolute; top: 12px; left: 0; right: 0; display: flex; justify-content: space-between; padding: 0 20px; }
    .logo-space { width: clamp(72px, 10vw, 96px); height: clamp(72px, 10vw, 96px); background: #fff; border: 2px solid #e2e8f0; border-radius: 16px; display: grid; place-items: center; box-shadow: 0 6px 15px rgba(0,0,0,0.15); }
    .logo-space img { width: 100%; height: 100%; object-fit: contain; border-radius: 12px; }

    .notebook-label { background: linear-gradient(145deg, #fef3c7, #fde68a); border: 3px solid #d97706; border-radius: var(--radius); padding: 12px 18px; width: min(700px, calc(100% - 48px)); margin: 24px auto 0; }
    .cover-title { font-family: 'Caveat', cursive; font-size: clamp(20px, 2.4vw, 28px); color: #92400e; text-align: center; }
    .cover-subtitle { font-family: 'Kalam', cursive; font-size: clamp(12px, 1.6vw, 16px); color: #b45309; font-weight: 600; text-align: center; margin-top: 2px; }

    .student-info { background: #fff; border: 2px solid #64748b; border-radius: 10px; padding: 16px 22px; width: clamp(360px, 62vw, 580px); box-shadow: 0 6px 20px rgba(0,0,0,0.2); }
    .info-line { display:flex; justify-content:space-between; align-items:center; font-size: clamp(12px,1.8vw,16px); border-bottom: 1px dotted #cbd5e1; padding: 6px 0; }
    .info-line:last-child { border-bottom: none; }
    .info-label { font-weight: 700; color: #475569; min-width: clamp(90px, 40%, 160px); }
    .info-value { color: var(--fie-red); font-weight: 700; text-align: right; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    .start-buttons { display:flex; gap:14px; justify-content:center; width:min(700px, calc(100% - 48px)); }
    .start-btn { background: linear-gradient(145deg, var(--fie-red), #7f1d1d); color:#fff; border:none; border-radius:var(--radius); padding:12px 18px; font-family:'Caveat', cursive; font-size: clamp(14px,1.8vw,18px); cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.3); }
    .start-btn.alt { background: linear-gradient(145deg, var(--fie-gold), #d97706); color:#111; }

    /* Utilidades */
    .two-column-layout { display:flex; gap:20px; align-items:flex-start; }
    .column-left, .column-right { flex:1; min-width:0; }
    .image-fallback { width:100%; min-height:240px; border-radius:10px; border:2px solid #e2e8f0; background:#fff no-repeat center/contain; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .image-caption { font-size: 11px; color:#718096; text-align:center; margin-top:6px; font-style: italic; }

    @media (max-width: 768px) {
      .app { grid-template-columns: 1fr; }
      .sidebar { position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); flex-direction: row; gap: 10px; width: calc(100vw - 40px); max-width: 600px; border-radius: 14px; }
      .workspace { padding: 10px; }
      .page-content { padding: 20px 20px 20px 108px; }
      .two-column-layout { flex-direction: column; }
    }

    /* Cajas de teor√≠a y firmas de funciones */
    .box { border:2px dashed #cbd5e1; background:#fff; border-radius:10px; padding:14px 16px; box-shadow:0 4px 12px rgba(0,0,0,0.08); margin:14px 0 18px; }
    .box .box-title { font-weight:700; color:#334155; margin-bottom:6px; }
    .box.note { border-color:#a7f3d0; background:#ecfeff; }
    .box.definition { border-color:#fde68a; background:#fff7ed; }
    .box.formula { border-color:#c4b5fd; background:#f5f3ff; }
    .box.example { border-color:#fecaca; background:#fff1f2; }
    /* Slots de imagen para insertar recortes del PDF */
    .img-slot {
      width: 100%; height: 140px; border-radius: 10px;
      border: 2px dashed #94a3b8; background: #f8fafc;
      display: flex; align-items: center; justify-content: center;
      color: #64748b; font-size: 0.95rem; margin-top: 8px;
    }
    .img-slot.small { height: 100px; }
    /* F√≥rmulas con presencia visual y centradas */
    .box.formula mjx-container { font-size: 1.28em; display:block; text-align:center; margin: 12px auto; }
    .box.formula mjx-container[display="true"] { margin: 12px auto; }
    mjx-container mjx-math { letter-spacing: 0.2px; }

    /* Tabla de f√≥rmulas (estilo tipo ficha) */
    .formula-table { width: 100%; border-collapse: collapse; border-radius: 10px; overflow: hidden; box-shadow: 0 3px 10px rgba(0,0,0,0.06); }
    .formula-table thead th { background: linear-gradient(180deg, #f59e0b, #d97706); color:#fff; text-align:center; padding:8px 10px; font-weight:700; border:1px solid rgba(0,0,0,0.05); }
    .formula-table tbody th { background: linear-gradient(180deg, #f59e0b, #d97706); color:#fff; text-align:left; padding:8px 12px; font-weight:700; border:1px solid rgba(0,0,0,0.05); width: 22%; }
    .formula-table td { background:#fff7ed; border:1px solid #f4b180; padding:8px 10px; text-align:center; }
    .formula-table td.shade { background:#fde9d3; }
    .formula-table mjx-container { display:block; margin: 6px auto; }

    .function-sig {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', monospace;
      font-size: 0.95em;
      background: linear-gradient(145deg, #f7f7fb, #eef2ff);
      border: 1px solid #c7d2fe;
      color: #1f2937;
      border-radius: 8px;
      padding: 6px 8px;
      margin: 8px 0;
      /* Presentaci√≥n centrada y numeraci√≥n autom√°tica */
      display: flex;
      align-items: baseline;
      justify-content: center;
      gap: 0.5rem;
      counter-increment: eqnum;
    }
    .function-sig::after {
      content: "(" counter(eqnum) ")";
      font-family: 'Kalam', cursive;
      font-size: 0.95em;
      color: #334155;
      margin-left: 0.5rem;
    }
    .function-sig mjx-container { font-size: 1.25em; }

    /* Flipbook: hoja animada que gira por encima del contenido */
    .page-turn { position:absolute; inset:0; pointer-events:none; z-index:4; display:none;
      background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(253,236,200,0.95) 60%, rgba(241,209,138,0.95) 100%);
      box-shadow: 0 12px 24px rgba(0,0,0,0.25);
    }
    .page-turn.flip-right { display:block; transform-origin:right center; animation: turnRight 900ms ease-in-out both; }
    .page-turn.flip-left  { display:block; transform-origin:left  center; animation: turnLeft  900ms ease-in-out both; }
    @keyframes turnRight {
      0%   { transform: perspective(1000px) rotateY(0deg);    opacity:0; }
      20%  {                       opacity:0.55; }
      50%  { transform: perspective(1000px) rotateY(-75deg);  opacity:0.45; }
      80%  { transform: perspective(1000px) rotateY(-100deg); opacity:0.25; }
      100% { transform: perspective(1000px) rotateY(-110deg); opacity:0; }
    }
    @keyframes turnLeft {
      0%   { transform: perspective(1000px) rotateY(0deg);   opacity:0; }
      20%  {                       opacity:0.55; }
      50%  { transform: perspective(1000px) rotateY(75deg);  opacity:0.45; }
      80%  { transform: perspective(1000px) rotateY(100deg); opacity:0.25; }
      100% { transform: perspective(1000px) rotateY(110deg); opacity:0; }
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <button class="nav-btn" onclick="goCover()">üè† Portada</button>
      <button class="nav-btn secondary" onclick="selectUnit(1)">üìò Unidad I</button>
      <button class="nav-btn secondary" onclick="selectUnit(2)">üìó Unidad II</button>
      <div id="weeks-list" class="weeks-list"></div>
      <button class="nav-btn" onclick="prevPage()">‚óÄÔ∏è Semana anterior</button>
      <button class="nav-btn" onclick="nextPage()">‚ñ∂Ô∏è Semana siguiente</button>
      <button class="nav-btn" onclick="printAll()">üñ®Ô∏è Imprimir</button>
    </aside>

    <main class="workspace">
      <div class="notebook-container">
        <div class="spiral-binding" aria-hidden="true"></div>
        <div class="notebook">
          <div class="binder-strip" aria-hidden="true"></div>
          <div id="current-page" class="page-content"></div>
          <div id="page-number" class="page-number">1</div>
          <div id="page-turn" class="page-turn" aria-hidden="true"></div>
        </div>
      </div>
    </main>
  </div>

  <script>
    let currentUnit = 0;
    let currentPageIndex = 0;
    const pageEl = document.getElementById('current-page');
    const pageNumEl = document.getElementById('page-number');
    const turnEl = document.getElementById('page-turn');
  const dogearHtml = '<div class="page-dogear" aria-hidden="true"></div>';
  let lastDirection = 'right';

    // Especificaci√≥n de p√°ginas por semana (Unidad I)
    const unit1WeekSpec = [
      { path: 'content/unidad1/week-01.html', pages: 5 },
      { path: 'content/unidad1/week-02.html', pages: 3 },
      { path: 'content/unidad1/week-03.html', pages: 3 },
      { path: 'content/unidad1/week-04.html', pages: 3 },
      { path: 'content/unidad1/week-05.html', pages: 3 },
      { path: 'content/unidad1/week-06.html', pages: 3 },
      { path: 'content/unidad1/week-07.html', pages: 3 },
      { path: 'content/unidad1/week-08.html', pages: 3 }
    ];

    const unit2WeekSpec = [
      { path: 'content/unidad2/week-09.html', pages: 1 },
      { path: 'content/unidad2/week-10.html', pages: 1 },
      { path: 'content/unidad2/week-11.html', pages: 1 },
      { path: 'content/unidad2/week-12.html', pages: 1 },
      { path: 'content/unidad2/week-13.html', pages: 1 },
      { path: 'content/unidad2/week-14.html', pages: 1 },
      { path: 'content/unidad2/week-15.html', pages: 1 }
    ];

    function buildFiles(spec) {
      const arr = [];
      for (let i = 0; i < spec.length; i++) {
        for (let p = 1; p <= spec[i].pages; p++) {
          arr.push(`${spec[i].path}#page-${p}`);
        }
      }
      return arr;
    }

    const files = {
      0: ['cover'],
      1: buildFiles(unit1WeekSpec),
      2: buildFiles(unit2WeekSpec)
    };

    // Etiquetas por semana y emoji-√≠cono
    const weekLabels = {
      1: ['Muestreo', 'üß™'],
      2: ['Distribuciones y TLC', 'üìà'],
      3: ['Estimaci√≥n puntual', 'üéØ'],
      4: ['IC de la media (œÉ conocida)', 'üìê'],
      5: ['IC de la media (œÉ desconocida) y p', 'üìè'],
      6: ['IC diferencias de medias/proporciones', '‚ûó'],
      7: ['Dise√±o muestral y errores', 'üóÇÔ∏è'],
      8: ['Repaso integrador', 'üß≠'],
      9: ['Fundamentos pruebas de hip√≥tesis', 'üîç'],
      10: ['Pruebas de medias y proporciones', '‚öñÔ∏è'],
      11: ['Dos muestras: medias y proporciones', 'üßØ'],
      12: ['Chi‚Äëcuadrado: ajuste e independencia', '‚ôüÔ∏è'],
      13: ['ANOVA de una v√≠a', 'üß¨'],
      14: ['Regresi√≥n y correlaci√≥n', 'üìä'],
      15: ['Repaso final y proyecto', '‚úÖ']
    };

    // Mapeos: √≠ndice de p√°gina ‚Üí semana mostrada y viceversa
    function mapIndexToWeek(unit, idx) {
      if (unit === 1) {
        let acc = 0;
        for (let w = 0; w < unit1WeekSpec.length; w++) {
          const c = unit1WeekSpec[w].pages;
          if (idx < acc + c) return w + 1;
          acc += c;
        }
        return unit1WeekSpec.length;
      } else if (unit === 2) {
        let acc = 0;
        for (let w = 0; w < unit2WeekSpec.length; w++) {
          const c = unit2WeekSpec[w].pages;
          if (idx < acc + c) return w + 9;
          acc += c;
        }
        return 15;
      }
      return 1;
    }
    function mapWeekToIndex(unit, w) {
      if (unit === 1) {
        let idx = 0;
        for (let i = 0; i < w - 1; i++) idx += unit1WeekSpec[i].pages;
        return idx;
      } else if (unit === 2) {
        let idx = 0;
        for (let i = 0; i < (w - 9); i++) idx += unit2WeekSpec[i].pages;
        return idx;
      }
      return 0;
    }

    function goCover() { currentUnit = 0; currentPageIndex = 0; renderCover(); renderWeeksList(); highlightActiveWeek(); }
    function selectUnit(u) { currentUnit = u; currentPageIndex = 0; renderPage(); renderWeeksList(); }

    function goWeek(w) {
      const currentAbs = mapIndexToWeek(currentUnit, currentPageIndex);
      lastDirection = (w > currentAbs) ? 'right' : 'left';
      if (w >= 1 && w <= 8) { currentUnit = 1; currentPageIndex = mapWeekToIndex(1, w); }
      else if (w >= 9 && w <= 15) { currentUnit = 2; currentPageIndex = mapWeekToIndex(2, w); }
      renderPage();
    }

    function renderCover() {
      pageEl.innerHTML = `
        ${dogearHtml}
        <div class="cover-page">
          <div class="logo-spaces">
            <div class="logo-space"><img src="../assets/una.png" alt="UNA" onerror="this.style.display='none'" /></div>
            <div class="logo-space"><img src="../assets/fie.png" alt="FIE" onerror="this.style.display='none'" /></div>
          </div>

          <div class="notebook-label">
            <div class="cover-title">üìä Estad√≠stica Inferencial</div>
            <div class="cover-subtitle">Facultad de Ingenier√≠a Econ√≥mica</div>
            <div class="cover-subtitle">Escuela Profesional de Ingenier√≠a Econ√≥mica</div>
            <div class="cover-subtitle">Cuaderno de Apuntes</div>
          </div>

          <div class="student-info">
            <div class="info-line"><span class="info-label">Estudiante:</span><span class="info-value">Edaly Yamileth Paredes Condori</span></div>
            <div class="info-line"><span class="info-label">Curso:</span><span class="info-value">Estad√≠stica Inferencial</span></div>
            <div class="info-line"><span class="info-label">Periodo:</span><span class="info-value">2025 - II</span></div>
            <div class="info-line"><span class="info-label">Universidad:</span><span class="info-value">Universidad Nacional del Altiplano</span></div>
            <div class="info-line"><span class="info-label">Facultad:</span><span class="info-value">Ingenier√≠a Econ√≥mica</span></div>
            <div class="info-line"><span class="info-label">Docente:</span><span class="info-value">Por confirmar</span></div>
          </div>

          <div class="start-buttons">
            <button class="start-btn" onclick="selectUnit(1)">üìò Unidad I</button>
            <button class="start-btn alt" onclick="selectUnit(2)">üìó Unidad II</button>
          </div>
        </div>`;
      pageEl.classList.remove('page-enter-left','page-enter-right');
      pageEl.offsetHeight;
      pageEl.classList.add('page-enter-right');
      pageNumEl.textContent = 1;
      // Reprocesar matem√°ticas por si la portada contiene f√≥rmulas
      if (window.MathJax) {
        const ready = (MathJax.startup && MathJax.startup.promise) ? MathJax.startup.promise : Promise.resolve();
        ready.then(() => MathJax.typesetPromise && MathJax.typesetPromise([pageEl]))
             .catch(err => console && console.error && console.error('MathJax typeset error (cover):', err));
      }
    }

    function renderPage() {
      const spec = files[currentUnit][currentPageIndex];
      const [path, frag] = spec.split('#');
      fetch(path)
        .then(r => r.ok ? r.text() : Promise.reject(new Error('No se pudo cargar '+path)))
        .then(html => {
          const tmp = document.createElement('div'); tmp.innerHTML = html;
          const node = tmp.querySelector('#'+frag);
          const contentHtml = node ? node.innerHTML : html;
          const shownWeek = mapIndexToWeek(currentUnit, currentPageIndex);
          const unitLabel = currentUnit === 1 ? 'Unidad I' : currentUnit === 2 ? 'Unidad II' : '‚Äî';
          const [topic, icon] = weekLabels[shownWeek] || ['Semana', 'üìò'];
          const headerHtml = `
            <div class="page-header">
              <div class="crumb">${unitLabel} ¬∑ Semana ${String(shownWeek).padStart(2,'0')}</div>
              <div class="topic">${icon} ${topic}</div>
              <div class="sticker"></div>
            </div>`;
          pageEl.innerHTML = dogearHtml + headerHtml + contentHtml;
          pageEl.classList.remove('page-enter-left','page-enter-right');
          pageEl.offsetHeight;
          pageEl.classList.add(lastDirection === 'right' ? 'page-enter-right' : 'page-enter-left');
          pageNumEl.textContent = shownWeek;
          highlightActiveWeek();
          // Forzar el renderizado de MathJax tras insertar contenido din√°mico
          if (window.MathJax) {
            const ready = (MathJax.startup && MathJax.startup.promise) ? MathJax.startup.promise : Promise.resolve();
            ready.then(() => MathJax.typesetPromise && MathJax.typesetPromise([pageEl]))
                 .catch(err => console && console.error && console.error('MathJax typeset error (page):', err));
          }
        })
        .catch(err => { pageEl.innerHTML = '<div style="color:#b91c1c">'+err.message+'</div>'; });
    }

    function nextPage() {
      if (!files[currentUnit] || currentUnit === 0) return;
      if (currentPageIndex < files[currentUnit].length - 1) {
        currentPageIndex++;
        lastDirection = 'right';
        renderPage();
        if (turnEl) { turnEl.classList.remove('flip-right','flip-left'); turnEl.offsetWidth; turnEl.classList.add('flip-right'); }
      }
    }

    function prevPage() {
      if (!files[currentUnit] || currentUnit === 0) return;
      if (currentPageIndex > 0) {
        currentPageIndex--;
        lastDirection = 'left';
        renderPage();
        if (turnEl) { turnEl.classList.remove('flip-right','flip-left'); turnEl.offsetWidth; turnEl.classList.add('flip-left'); }
      }
    }

    function renderWeeksList() {
      const list = document.getElementById('weeks-list');
      if (!list) return;
      list.innerHTML = '';
      let start = 1, end = 15;
      if (currentUnit === 1) { start = 1; end = 8; }
      else if (currentUnit === 2) { start = 9; end = 15; }
      else { start = 1; end = 0; } // portada: ocultar hasta elegir unidad

      if (end >= start) {
        for (let w = start; w <= end; w++) {
          const [label, icon] = weekLabels[w] || ['Semana '+w, 'üìò'];
          const btn = document.createElement('button');
          btn.className = 'week-item';
          btn.textContent = `${icon} S${String(w).padStart(2,'0')} ¬∑ ${label}`;
          btn.onclick = () => { const before = (currentUnit === 1 ? (currentPageIndex + 1) : (currentUnit === 2 ? (currentPageIndex + 9) : 0)); goWeek(w); if (turnEl) { const after = (currentUnit === 1 ? (currentPageIndex + 1) : (currentUnit === 2 ? (currentPageIndex + 9) : 0)); const dir = after > before ? 'flip-right' : 'flip-left'; turnEl.classList.remove('flip-right','flip-left'); turnEl.offsetWidth; turnEl.classList.add(dir); } };
          list.appendChild(btn);
        }
      } else {
        const tip = document.createElement('div');
        tip.style.cssText = 'color:#fff; opacity:0.85; font-size:12px; text-align:center; padding:8px';
        tip.textContent = 'Selecciona una unidad para ver sus semanas';
        list.appendChild(tip);
      }
      highlightActiveWeek();
    }

    function highlightActiveWeek() {
      const list = document.getElementById('weeks-list'); if (!list) return;
      const items = list.querySelectorAll('.week-item'); items.forEach(i => i.classList.remove('active'));
      const w = mapIndexToWeek(currentUnit, currentPageIndex);
      if (w >= 1 && w <= 15) {
        const idx = w - 1;
        const node = items[idx]; if (node) node.classList.add('active');
      }
    }

    function printAll() { window.print(); }

    // Atajos de teclado
    document.addEventListener('keydown', (e) => {
      const key = e.key;
      if (key === 'ArrowRight') { e.preventDefault(); nextPage(); }
      else if (key === 'ArrowLeft') { e.preventDefault(); prevPage(); }
      else if (key === 'Home') { e.preventDefault(); goCover(); }
      else if (key === '1') { e.preventDefault(); selectUnit(1); }
      else if (key === '2') { e.preventDefault(); selectUnit(2); }
    });

    // Inicial
    renderWeeksList();
    goCover();
  </script>
</body>
</html>
